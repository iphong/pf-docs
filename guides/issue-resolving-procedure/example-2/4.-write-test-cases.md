---
description: >-
  Fix pages published by PageFly losing styles on the storefront of a customer.
  This example is credited to ThanhLM (Kevin).
---

# 4. Write test cases

In this example, we will "fix pages published by PageFly losing styles on the storefront of a customer". In [step 1](1.-understand-the-issue.md), we understand that the problem occurs because the Shopify theme has two `</head>` tags. We also found that a similar problem might occur if a Shopify theme has multiple `{{ content_for_layout }}` tags.

Based on this understanding and the solution we choose in [step 3](3.-choose-one-solution.md), we can write the following list of test cases.

* _If a Shopify theme has multiple `</head>` tags, page assets must be inserted above all `</head>` occurrences._
* _If a Shopify theme has multiple `{{ content_for_layout }}` tags, all `{{ content_for_layout }}` occurrences must be replaced with page content._

{% hint style="info" %}
At this time, you need to submit a solution proposal. Open [this form](https://docs.google.com/forms/d/e/1FAIpQLSc8IcTnfy\_6Y92hScpEwUMpfWXQengWYQtxPXiXPbmStBWilw/viewform), fill in the following information, and submit the form. Wait for your solution proposal to be approved before continuing to [step 5](5.-test-and-code.md) to update the existing test script with new test cases and code the solution.

**What is the problem?**

* A Shopify theme might have multiple `</head>` tags placed in a control statement but PageFly only inserts page assets before the first `</head>` tag.
* PageFly does not handle Shopify themes having multiple `</head>` tags inside a control statement because the developer did not think a non-standard case like this is allowed by Shopify.
* We need to ensure the loading of page assets and page content does not depend on how a Shopify theme renders `</head>` and `{{ content_for_layout }}` tags.

**Ways to solve the problem?**

1. The first solution is to insert page assets before all `</head>` tags and replace all occurrences of the `{{ content_for_layout }}` tag with page content in the layout template file.
2. The second solution is to wrap page assets in a dedicated `<head></head>` block and insert it right after the `<html>` tag.

**Which solution do you propose?**

The simplest and most effective solution is the first solution because it can resolve both the specified case and a similar case that replaces the `{{ content_for_layout }}` tag with page content.

**What are the test cases you defined?**

1. On the `pfserver` project:\
   \- If a Shopify theme has multiple `</head>` tags, page assets must be inserted above all `</head>` occurrences.\
   \- If a Shopify theme has multiple `{{ content_for_layout }}` tags, all `{{ content_for_layout }}` occurrences must be replaced with page content.
{% endhint %}

|                                                            Current step | Next step                                                         |
| ----------------------------------------------------------------------: | ----------------------------------------------------------------- |
| [4.-write-test-cases.md](../processes/4.-write-test-cases.md "mention") | [5.-test-and-code.md](../processes/5.-test-and-code.md "mention") |
